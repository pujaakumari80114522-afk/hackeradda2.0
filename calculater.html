<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simple Calculator</title>
  <style>
    :root{
      --bg:#0f1724; /* dark */
      --panel:#0b1220;
      --accent:#7c3aed;
      --btn:#111827;
      --btn-light:#1f2937;
      --text:#e6eef8;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#071029 0%, #081522 100%);display:flex;align-items:center;justify-content:center;padding:24px;color:var(--text)}
    .calculator{width:340px;max-width:95%;background:linear-gradient(180deg,var(--panel),#071022);border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(2,6,23,0.7)}

    .screen{background:rgba(255,255,255,0.03);padding:14px;border-radius:10px;display:flex;flex-direction:column;gap:6px;min-height:90px}
    .history{font-size:13px;opacity:0.6;min-height:18px;word-break:break-all}
    .display{font-size:28px;font-weight:600;text-align:right;word-break:break-all}

    .pad{margin-top:14px;display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
    button{border:0;padding:14px;border-radius:10px;font-size:18px;cursor:pointer;user-select:none}
    .btn-ctrl{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,0.04)}
    .btn-op{background:linear-gradient(180deg,rgba(124,58,237,0.95),rgba(99,102,241,0.9));color:white}
    .btn-num{background:var(--btn-light);color:var(--text)}
    .span-2{grid-column:span 2}

    .help{margin-top:10px;font-size:13px;opacity:0.7;text-align:center}

    @media (max-width:420px){.display{font-size:24px}.screen{min-height:76px}}
  </style>
</head>
<body>
  <main class="calculator" role="application" aria-label="Calculator">
    <div class="screen">
      <div class="history" id="history"></div>
      <div class="display" id="display">0</div>
    </div>

    <div class="pad" role="group" aria-label="Calculator keypad">
      <button class="btn-ctrl" data-action="clear">C</button>
      <button class="btn-ctrl" data-action="neg">+/-</button>
      <button class="btn-ctrl" data-action="percent">%</button>
      <button class="btn-op" data-action="op">÷</button>

      <button class="btn-num" data-num="7">7</button>
      <button class="btn-num" data-num="8">8</button>
      <button class="btn-num" data-num="9">9</button>
      <button class="btn-op" data-action="op">×</button>

      <button class="btn-num" data-num="4">4</button>
      <button class="btn-num" data-num="5">5</button>
      <button class="btn-num" data-num="6">6</button>
      <button class="btn-op" data-action="op">-</button>

      <button class="btn-num" data-num="1">1</button>
      <button class="btn-num" data-num="2">2</button>
      <button class="btn-num" data-num="3">3</button>
      <button class="btn-op" data-action="op">+</button>

      <button class="btn-num span-2" data-num="0">0</button>
      <button class="btn-num" data-num=".">.</button>
      <button class="btn-op" data-action="equals">=</button>
    </div>

    <div class="help">Tip: use keyboard — numbers, + - * /, Enter for =, Backspace for delete</div>
  </main>

  <script>
    // Simple calculator logic
    (function(){
      const displayEl = document.getElementById('display');
      const historyEl = document.getElementById('history');
      let current = '0';
      let expression = '';
      let lastResult = null;

      function updateScreen(){
        displayEl.textContent = current;
        historyEl.textContent = expression;
      }

      function inputNumber(n){
        if(current === '0' && n !== '.') current = n;
        else if(current.includes('.') && n === '.') return;
        else current = current + n;
        updateScreen();
      }

      function clearAll(){ current = '0'; expression = ''; lastResult = null; updateScreen(); }

      function toggleNeg(){
        if(current === '0') return;
        current = (parseFloat(current) * -1).toString();
        updateScreen();
      }

      function percent(){
        current = (parseFloat(current) / 100).toString();
        updateScreen();
      }

      function pushOperator(opSymbol){
        // flush current into expression
        if(expression === '' && lastResult !== null && current === '0'){
          expression = String(lastResult);
        }
        // prevent two operators in a row
        if(expression === '' && current === '0') return;
        expression += (expression && /[+\-×÷*\/]$/.test(expression) ? '' : '') + current + opSymbol;
        current = '0';
        updateScreen();
      }

      function evaluateExpression(){
        if(expression === '' && lastResult === null) return;
        // build eval-safe string: replace × ÷ with * /
        let expr = expression + current;
        expr = expr.replace(/×/g, '*').replace(/÷/g, '/');
        // Only allow digits, operators, dot, parentheses
        if(!/^[0-9.+\-*/() %]+$/.test(expr)){
          current = 'Error'; updateScreen(); return;
        }
        try{
          // using Function is slightly safer than eval in this context
          const result = Function('return (' + expr + ')')();
          lastResult = Number.isFinite(result) ? result : 'Error';
          current = String(lastResult);
          expression = '';
        }catch(e){ current = 'Error'; }
        updateScreen();
      }

      // button handling
      document.querySelectorAll('button').forEach(btn => {
        btn.addEventListener('click', ()=>{
          const n = btn.getAttribute('data-num');
          const action = btn.getAttribute('data-action');
          if(n !== null){ inputNumber(n); return; }
          if(action === 'clear'){ clearAll(); return; }
          if(action === 'neg'){ toggleNeg(); return; }
          if(action === 'percent'){ percent(); return; }
          if(action === 'op'){
            const op = btn.textContent.trim();
            pushOperator(op);
            return;
          }
          if(action === 'equals'){ evaluateExpression(); return; }
        })
      });

      // keyboard support
      window.addEventListener('keydown', (e)=>{
        if(e.key >= '0' && e.key <= '9'){ e.preventDefault(); inputNumber(e.key); return; }
        if(e.key === '.') { e.preventDefault(); inputNumber('.'); return; }
        if(e.key === 'Enter' || e.key === '='){ e.preventDefault(); evaluateExpression(); return; }
        if(e.key === 'Backspace'){ e.preventDefault();
          // delete last char of current
          if(current.length > 1) current = current.slice(0,-1);
          else current = '0';
          updateScreen();
          return;
        }
        if(['+','-','/','*'].includes(e.key)){
          e.preventDefault();
          const map = {'*':'×','/':'÷'};
          pushOperator(map[e.key] || e.key);
          return;
        }
        if(e.key.toLowerCase() === 'c'){ e.preventDefault(); clearAll(); return; }
      })

      // initialization
      updateScreen();
    })();
  </script>
</body>
</html>
